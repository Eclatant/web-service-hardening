### 목차 

* [SELiux 란](###SELiux-란)
* [접근 통제](#접근-통제)
* [임의 접근 통제](#임의-접근-통제)
* [강제 접근 통제](#강제-접근-통제)

### SELiux 란

SELinux 는 레드햇 계열의 배포판의 사용자들이 가장 증오하는 기능일 겁니다.
검색 엔진에서 SElinux 를 치면 끄기가 자동 완성되니까요.

이것은 우리나라만이 아니라 외국도 마찬가지이며 SELinux 의 장점과 중단했을 때의  문제점을 널리 알리기 위한 [stop disabling SELinux](http://stopdisablingselinux.com/) 사이트도 생겨났습니다.

그러면 SELinux는 대체 무엇이며 왜 이리 사용자들의 증오를 받는 것일까요.

SELinux는 미국의 국가 안보국(NSA; National Security Agency; 또는 하도 비밀이 많아서 No such Agency 라고도 합니다.)에서 개발한 플라스크(Flask)라는 보안 커널을 리눅스에 이식한 커널 레벨의 보안 모듈입니다.

NSA는 다양한 운영체제에 강제 접근 통제를 구현했고 이를 리눅스 커널에도 포팅해서 결과물을 리눅스 커뮤니티에 기증해서 2.6 버전의 커널에 공식 포함되었습니다.

RHEL 기반의 배포판에는 4 버전부터 공식적으로 포함되었으며 다양한 제품들이 현재는 SELinux를 지원합니다.


그러면 SELinux 를 이해하기 위해 필수적인 지식인 강제 접근 통제와 임의 접근 통제에 대해서 알아 봅시다.

### 접근 통제

운영체제에서 접근 통제(Access Control)은 디렉터니라 파일, 네트워크 소켓 같은 시스템 자원을 적절한 권한을 가진 사용자나 그룹이 접근하고 사용할 수 있게 통제하는 것을 의미합니다.

접근 통제애서는 시스템 자원을 객체(Object)라고 하며 자원에 접근하는 사용자나 프로세스는 주체(Subject)라고 합니다.

즉 /etc/passwd 파일은 객체이고 이 파일에 접근해서 암호를 수정할 수 있게 해주는 passwd 라는 명령어는 주체입니다.

### 임의 접근 통제

임의 접근 통제(DAC;Discretionary Access Control)는 시스템 객체에 대한 접근을 사용자나 또는 그룹의 신분을 기준으로 제한하는 방법입니다.

사용자나 그룹이 객체의 소유자라면 다른 주체에 대해 이 객체에 대한 접근 권한을 설정할 수 있습니다.

여기서 임의적이라는 말은 소유자는 자신의 판단에 의해서 권한을 줄 수 있다는 의미이며 구현이 용이하고 사용이 간편하기 때문에 전통적으로 유닉스나 윈도우등 대부분의 운영체제의 기본 접근 통제 모델로 사용되고 있습니다.

임의적 접근 통제는 사용자가 임의로 접근 권한을 지정하므로 사용자의 권한을 탈취당하면 사용자가 소유하고 있는 모든 객체의 접근 권한을 가질 수 있게 되는 치명적인 문제가 있습니다.

임의적 접근 통제 방식의 보안 취약점에 대해 설명하기 위해 유닉스의 setuid 비트와 에 대해서 알아 봅시다.

사용자들은 자신의 암호를 passwd 명령어를 실행하여 변경할 수 있는데 사용자의 암호는 /etc/shadow 에 저장되며 이 파일은 루트만 접근 가능하지만 일반 사용자도 passwd 명령어로 자신의 암호를 변경할 수 있습니다.

또 상대방 호스트가 동작하는지 확인하기 위해 ping 명령어를 입력할 경우 ping 은 ICMP(Internet Control Message Protocol) 패킷을 사용하므로 루트 권한이 필요하지만 일반 사용자도 ping 명령어를 사용하여 상대 호스트의 이상 여부를 확인할 수 있습니다.

이는 passwd 나 ping 같이 실행시 루트 권한이 필요한 프로그램에는 setuid 비트라는 것을 설정하여 실행한 사용자가 누구든지 setuid 비트가 설정된 프로그램은 루트로 동작하도록 설계하였으므로 가능한 일입니다.
 
 ```
 ls -l /bin/ping/ /usr/bin/passwd
 ```

위 명령어를 실행하면 파일의 퍼미션 부분에 's' 표시가 있는 프로그램들은 setuid 비트가 켜졌다고 하며 이런 프로그램들은 실행시 루트 권한을 갖고 구동됩니다.

그러므로 일반 사용자들도 자신의 암호를 변경할 수 있지만 만약 setuid 비트가 붙은 프로그램에 보안 취약점이 있을 경우 공격자는 손쉽게 루트 권한을 획득할 수 있는 문제가 있습니다. 

이때문에 setuid 비트는 필요하지만 유닉스 시스템의 주요 보안 취약점이었으며 시스템 관리자의 골칫 덩어리이었습니다.

시스템에 있는 setuid 비트가 붙은 프로그램은 다음 명령어로 찾을 수 있습니다.

```
find /bin /usr/bin /sbin -perm -4000 -exec ls -ldb {} \;
```

### 강제 접근 통제

11

### 참고 자료

* [20 Linux Server Hardening Security Tips](http://www.cyberciti.biz/tips/linux-security.html)
